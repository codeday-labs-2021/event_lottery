<!DOCTYPE html>
<html>

<head>
  <title>Parcel Sandbox</title>
  <meta charset="UTF-8" />
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
    integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
  <link rel="stylesheet" href="styles.css">
</head>

<body>
  <div id="app" class="app">
    <div  >
      <div  >
        <form id="form" method="POST">
          <h1>URL-shortener</h1>
          <p>Please input your url to get a shortned version</p>
          <div class="row"> 
            <div class="col-12">
          <div class="form-group">


            <label>Enter Your Url</label>
            <input type="text" id="longurl" placeholder="Enter URL" name="url" class="form-control" required />
          </div>
            </div>
          </div>
          <div class="buttons">

            <button id="submit" type="submit" class="btn btn-primary mb-2">Shorten</button>
          </div>
          <div id="shorturl" class="container"></div>
           
        </form>
      </div>
      <div id="urllist" class="listcant"></div>
    </div>
  </div>



<script src="main.js"></script>
</body>
<script>

  const form = document.getElementById('form')
  form.addEventListener('submit', function (e) {
    e.preventDefault()
    const url = document.getElementById('longurl').value
    console.log(url)
    //featch
    // fetch(`http://localhost:8080/register`,{
    fetch('http://localhost:8080/register', {
      method: 'POST',
      //mode: 'same-origin', 
      headers: {
        'Accept': 'application/json',
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({
        longurl: url
      })
    })
      .then(function (response) {
        return response.json()
        //console.log('Request success: ', data);  
      })
      .then(function (data) {
        console.log(data)
        var result = document.getElementById('shorturl')
        result.innerHTML = `<div class="card text-center">
  <div class="card-header">
    New Url
  </div>
  <div class="card-body">
     
    <p class="card-text">${data}</p>
     
  </div>
   
</div>`
      })
      .catch(function (error) {
        console.log('Request failure: ', error);
      });
  })
 
  /*function fetchText() {
    fetch('http://localhost:8080/list', {
      headers: {
        'Content-Type': 'application/json',
        Accept: 'application/json'
      }
    })
      .then(function (response) {
        if (response.ok) {
          console.log(response.json);
          return response.json();
        }
        return Promise.reject(response);
      })

      .then(function (responseJSON) {
        console.log(responseJSON);
        let urllist=document.getElementById('urlist') 
        let output='';
        responseJSON.forEach(element => {
          console.log(element)
          output+=` <div>
      <br></br>
      <Table striped bordered hover className="textcenter">
        <thead>
          <tr>
             
            <th width={"70%"}>Long url</th>
            <th>Short url</th>
          </tr>
        </thead>
        <tbody>
                <tr>
                   
                  <td>${element.ID}</td>
                  <td>${element.longurl}
                    
                  </td>
                </tr>
              );
            })}
        </tbody>
      </Table>`;

        });
         
        urllist.innerHTML=output;
      })
      .catch(error => {
        console.log(error)
      })
  }

  fetchText();*/
  fetchText();
</script>

</html>